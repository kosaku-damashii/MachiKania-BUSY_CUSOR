REM BUSY CURSOR
USECLASS BSYCSR
USEGRAPHIC 10

USEVAR MAXNUM,MAXW,MAXH,BALLR
USEVAR BALL
MAXW=SYSTEM(22):MAXH=SYSTEM(23)
MAXNUM=5
BALLR=16
DIM BALL(MAXNUM),T(32*32/4)
FOR C=0 TO 15
  GPALETTE 0xFF-C,255-C*C,255-C*C,255-C*C
NEXT
FOPEN "B032_16B.BMP","r"
FSEEK 54
FOR C=0 TO 15
  B=FGETC():G=FGETC()
  R=FGETC():D=FGETC()
  GPALETTE C,R,G,B
NEXT
FOR I=31 TO 0 STEP -1
  FGET T+I*32,32
NEXT
FCLOSE
BOXFILL 0,0,MAXW,MAXH,$F
FOR N=0 TO MAXNUM-1
  BALL(N)=NEW(BSYCSR, -N*(BALLR*3+25), MAXH, MAXW, BALLR)
NEXT
DO
  FOR N=0 TO MAXNUM-1
    B=BALL(N)
    B.LOCATE()
    IF     ((B.DEG % 360) > 270) THEN
      B.DEG=B.DEG+6
    ELSEIF ((B.DEG % 360) > 180) THEN
      B.DEG=B.DEG+2
    ELSEIF ((B.DEG % 360) >  90) THEN
      B.DEG=B.DEG+6
    ELSE
      B.DEG=B.DEG+6
    ENDIF
    IF B.DEG > 360*3 THEN B.DEG=-360
    IF (B.DEG >= 0) THEN
      B.DRAW()
    ENDIF
  NEXT
  WAIT 1
  FOR N=0 TO MAXNUM-1
    BALL(N).CLR()
  NEXT
    IF INKEY()!=0 THEN BREAK
NEXT
END

REM CLASS "BSYCS5"
OPTION CLASSCODE
FIELD PRIVATE I0#,R0,H0,W0,RINGR#,YB
FIELD PUBLIC DEG,X0,Y0

METHOD INIT
  DEG=ARGS(1)
  H0=ARGS(2)
  W0=ARGS(3)
  R0=ARGS(4)+2
  RINGR#=FLOAT#(H0/2-R0-10)
  YB=H0/2+INT(RINGR#)+R0
RETURN

METHOD LOCATE
  I0#=FLOAT#(DEG)
  X0=W0/2+INT(RINGR#*COS#(I0#*2*PI#/360))
  Y0=H0/2+INT(RINGR#*SIN#(I0#*2*PI#/360))
RETURN

METHOD GETX
RETURN X0

METHOD GETY
RETURN Y0

METHOD DRAW
  LINE X0- 7+X,YB-8,X0+15-9+X,YB-8,0xF0+(Y0/10)
  LINE X0-11+X,YB-7,X0+15-5+X,YB-7,0xF0+(Y0/10)
  LINE X0-14+X,YB-6,X0+15-2+X,YB-6,0xF0+(Y0/10)
  LINE X0-16+X,YB-5,X0+15+X  ,YB-5,0xF0+(Y0/10)
  LINE X0-16+X,YB-4,X0+15+X  ,YB-4,0xF0+(Y0/10)
  LINE X0-14+X,YB-3,X0+15-2+X,YB-3,0xF0+(Y0/10)
  LINE X0-11+X,YB-2,X0+15-5+X,YB-2,0xF0+(Y0/10)
  LINE X0- 7+X,YB-1,X0+15-9+X,YB-1,0xF0+(Y0/10)
  PUTBMP X0-16+X,Y0-16+Y,32,32,T
RETURN

METHOD CLR
  BOXFILL X0-16+X,YB-8,X0+15+X,YB-1,0x0F
  CIRCLEFILL X0,Y0,R0,0x0F
RETURN
