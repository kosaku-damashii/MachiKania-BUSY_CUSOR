REM BUSY CURSOR
USECLASS BSYCSR
USEGRAPHIC 10

USEVAR MAXNUM,MAXW,MAXH,BALLR
USEVAR BALL
MAXW=SYSTEM(22):MAXH=SYSTEM(23)
MAXNUM=5
BALLR=16
DIM BALL(MAXNUM),T(32*32/4)
FOR C=0 TO 15
  GPALETTE 0xFF-C,255-C*C,255-C*C,255-C*C
NEXT
FOPEN "B032_16B.BMP","r"
FSEEK 54
FOR C=0 TO 15
  B=FGETC():G=FGETC()
  R=FGETC():D=FGETC()
  GPALETTE C,R,G,B
NEXT
FOR I=31 TO 0 STEP -1
  FGET T+I*32,32
NEXT
FCLOSE
BOXFILL 0,0,MAXW,MAXH,$F
FOR N=0 TO MAXNUM-1
  BALL(N)=NEW(BSYCSR, -N*(BALLR*3+25), MAXH, MAXW, BALLR)
NEXT
DO
  FOR N=0 TO MAXNUM-1
    B=BALL(N)
    B.LOCATE()
    IF     ((B.DEG % 360) > 270) THEN
      B.DEG=B.DEG+6
    ELSEIF ((B.DEG % 360) > 180) THEN
      B.DEG=B.DEG+2
    ELSEIF ((B.DEG % 360) >  90) THEN
      B.DEG=B.DEG+6
    ELSE
      B.DEG=B.DEG+6
    ENDIF
    IF B.DEG > 360*3 THEN B.DEG=-360
    IF (B.DEG >= 0) THEN
      B.DRAW()
    ENDIF
  NEXT
  WAIT 1
  FOR N=0 TO MAXNUM-1
    BALL(N).CLR()
  NEXT
    IF INKEY()!=0 THEN BREAK
LOOP
END
